This readme will explain step by step how to set up impd4e by using the probe adapter.
--------------------------------------------------------------------------------------

I.) SETTING UP THE WEBINTERFACE
------------------------------------

1) At first it is necessary to copy the folder 'ptm' in your local /opt-folder.

2) Make sure that at '/opt/ptm/ra/' is a folder named 'probeAdapter'.
In this folder should be the files 'probeAdapter.py' and '__init__.py'

3) Open a terminal and switch to the folder '/opt/ptm/bin'.
Then enter 'sh ptmhub' to start the PTM-Hub.

4) When the PTM-Hub is started successfully open a second terminal in the same folder '/opt/ptm/bin'.
Now enter 'sh rarunner probeAdapter.probeAdapter.probeAdapter' to start the probe adapter.

NOTE: If there are other adapters currently running, the probe adapter possible won't start
because the port where the adapter runs on default will be already taken. So in that case you
have to add '--port=<your specific port>'. On default the port will be 8001. So if an adapter
is currently running on this port, just choose port 8002, 8003 or else.

5) When the probe adapter started successfully open an internet browser.
Then enter the URL 'http://127.0.0.1:8000/'.

Now you should see a webinterface with the logo of Fraunhofer FOKUS.
Also there should be a 'List of resources for I' whith one element '/probeResource-0'.
This element is always there, so you don't have to care about it.



II.) STARTING A PROBE WITH THE PROBE-ADAPTER
---------------------------------------------

1) Below in the interface you should see the link 'Add a new resource instance here'.
Click on this link.

2) Now you should see a new interface where you can enter the typename and 10 parameters.

3) At first you have to enter 'probeResource' in the typename-field.

4) With the other 10 parameters you can specify the options how the probe will be started.

There a 10 options available:



///////////////////////////////////////////////////////////////////////////////////////



i) interface
-------------

This option contains the interface which the probe will be listen on.

NOTE: On default the probe will be listen on 'eth0'.
So if you want to listen on 'eth0', you can let this option free.

If you want to listen to another interface you have to perform the following steps:

- At first type 'interface' in the name of the parameter.
- Then set the parameter type to 'string'.
- At last enter the interface you want to listen to.

For example:
eth1

For this example the probe will listen on the interface 'eth1'.



ii) oid
--------

This option contains the observation ID.

NOTE: On default the obervation ID will be numbered from 1 in ascending order.
If you want to enumerate your obervation ID's from 1 in ascending order, you can
let this option free.

If you want to specify your own observation ID you have to perform the following steps:

- At first type 'oid' in the name of the parameter.
- Then set the parameter type to 'string'.
- At last enter the observation ID in the value field.

For example:
23001

For this example the probe will have the Observation ID '23001'.



iii) location
--------------

This option contains the latitude, the longitude and the export ratio of the probe location.

NOTE: On default the latitude will be 52 and the longitude 13. So the probe will be located in Berlin.
Also the export ratio wille be on default 2 seconds. If it's not important for you where the probe is located,
you can let this option free.

If you want to specify your own location and your own export ratio you have to perform the following steps:

- At first type 'location' in the name of the parameter.
- Then set the parameter type to 'string'.
- At last specify the location, you have enter the latitude, the longitude and the export
ratio with the following syntax in the value field:

<latitude>:<longitude>:<export Ratio>

For example:
30:30:2

For this example the probe will be located on the latitude 30 and the longitude 30,
which is somewhere in egypt. Also the probe will export every 2 seconds his location information.



iv) collector
--------------

This option contains the IP-address and the port of the collector.

NOTE: On default the collector ip will be the machine, where the probeAdapter is running on and
the port will be 4739. If the collector is running on the same machine, where you are running the
probeAdapter and the collector is on the port 4739, you can let this option free. 

If the collector runs on another machine, you have to perform the following steps:

- At first type 'collector' in the name of the parameter.
- Then set the parameter type to 'string'.
- At last type the IP-address and the port of the collector with the following syntax in the value field:

<collector-IP>:<collector-Port>

For example:
10.147.65.144:4739

For this example the probe will send his information to the host 10.147.65.144.
The collector port will be 4739.



v) packetFilter
----------------

This option contains the berkeley filter expression.

NOTE: On default there won't be any berkely filter.If you don't want to set up any filter,
you can let this option free.

If you want to enter a berkeley filter expression, you have to perform the following steps:

- At first type 'packetFilter' in the name of the parameter.
- Then set the parameter type to 'string'.
- At last type your berkeley filter expression you want to have in the value field.

For the right syntax see manuals for the berkeley filter.
For example see: http://biot.com/capstats/bpf.html



vi) samplingRatio
------------------

This option contains the sampling Ratio of the probe.

NOTE: On default the samling ratio will be 100%. If you want to set up the
probe with a sampling ratio of 100%, you can let this option free.

If you want to specify a special sampling ratio, you have to perform the following steps:

- At first type 'samplingRatio' in the name of the parameter first.
- Then set the parameter type to 'string'.
- At last type the percentage of the sampling Ratio you want to have for this probe in the value field.

For example:
60.0

For this example the sampling Ratio will be 60%.



vii) install
-------------

This option specifies if all needed dependencies for the probe will be installed on the machine,
where you want to start the probe, before running impd4e.

NOTE: On default nothing will be installed before running impd4e. If you just want to
start the probe, you can let this option free.

If you want to install all needed depencies for the probe on the spefified machine,
you have to perform the following steps:

- At first type 'install' in the name of the parameter first.
- Then set the parameter type to 'string'.

There is no need to enter a value in the value field, because this option is just a flag.
The probeAdapter will ignore the content of the value field.



iix) target
------------

This option specifies the node where you want to start the probe. So it is necessary that already
a NodeAdapter is running, that already holds some nodes.

NOTE: On default the probe will be started on the machine where the probeAdapter is running.
If you want to start the probe on the machine where the probeAdapter is running, you can let
this option free.

If you want to start the probe on a certain machine, you have to perform the following steps:

- At first type 'target' in the name of the parameter first.
- Then set the parameter type to 'reference'. (NOT 'string' !)
- At last type the identifier of the node where you want to start the probe in the value field.

For example:
/pnode-1

For this example the selected node will be '/pnode-1'.



ix) resource
-------------

Like the option 'target', this option contains the node where you want to start the probe.

NOTE: On default the probe will be started on the machine where the probeAdapter is running.
If you want to start the probe on the machine where the probeAdapter is running, you can let
this option free.

If you want to start the probe on a certain machine, you have to perform the following steps:

- At first type 'target' in the name of the parameter first.
- Then set the parameter type to 'string'. (NOT 'reference' !)
- At last type the identifier of the node where you want to start the probe in the value field.

NOTE: It is important that you type the same identifier in the value field as in the value field
of the 'target'-option.



x) username
------------

This option contains the username of the node specified in the options 'target' and 'resource'.

NOTE: On default the username will be 'root'. If you want to start the probe on the specified node
under the username 'root', you can let this option free.

If you want to use another username, you have to perform the following steps:

- At first type 'username' in the name of the parameter.
- Then set the parameter type to 'string'.
- At last type the username in the value field:

For example:
prism

NOTE: It is important that the specified node in the options 'target' and 'resource' contains the password
you need for the username you want to specify.

For this example the probe will be started on the specified node under the username 'prism'.



///////////////////////////////////////////////////////////////////////////////////////



If you've entered all your options, click on the button 'Submit Query'.
Otherwise you can click on the button 'cancel' to return to the main webinterface.

If you click on the button 'Submit Query' the probe will be setted up.

After you've submitted the query go to the terminal where you started the probe adapter.

If you used the 'install'-option you should see how the probe adapter installs
all needed dependencies where you want to start the probe. You can check here if any errors
occur during the installation.

After that you will return to the main webinterface. You now should see,
that a new element is in your list.
This element should be called '/probeResource-<your entered Obervation ID>'.

The probe adapter will always start the probe inside a screen-session.
If you want to view the screen-session where the probe is, first log in to the machine, where
the probe is running and then type 'screen -r probe<number of the wanted probe>'

You can also see all probes on a machine by tying 'screen -ls'.

You can start other probes in the same way.

///////////////////////////////////////////////////////////////////////////////////////

Take a look the document 'Packettracking_Adapter_Parameters.pdf'.
This document contains a summary of all parameters of the probeAdapter.

